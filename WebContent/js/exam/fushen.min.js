layui.config({base:basePath+"js/",version:(new Date).getTime()});layui.use(["laypage","layer","table","element","slider","commons","combo","form","laydate"],function(){var e={};var t=[];var a=layui.laypage,l=layui.layer,i=layui.table,r=layui.element,o=layui.slider,n=layui.form,s=layui.commons(),d=layui.jquery,c=layui.combo(),u=layui.laydate;var f=l.load(1,{shade:[.5,"#ccc"]});i.render({id:"userTable",elem:"#demo",height:"full-0",method:"post",url:basePath+"qualify/queryPage.do",title:"课程列表",limit:10,limits:[10,15,20,30,50,100],page:{layout:["limit","prev","page","next","skip","count"],groups:5},toolbar:"#toolbar",defaultToolbar:[],totalRow:false,cols:[[{type:"checkbox"},{type:"numbers",title:"序号",align:"center",width:70},{field:"userCode",title:"工号",align:"center",width:100},{field:"username",title:"姓名",align:"center",width:100},{field:"department",title:"部门",align:"center",width:100},{field:"workShop",title:"科室/车间",align:"center",width:100},{field:"workGroup",title:"班组",align:"center",width:100},{field:"post",title:"岗位",align:"center",width:100},{field:"beginDate",title:"生效时间",align:"center",width:100},{field:"endDate",title:"失效时间",align:"center",width:100},{templet:function(e){return["正常","待复审","过期","复审中","复审未通过"][e.state*1]},title:"状态",align:"center",width:100}]],done:function(a){lay(".test-item").each(function(){u.render({elem:this,format:"yyyy-MM-dd",trigger:"click"})});t=a.data;l.close(f);n.val("queryform",e);var i=this.elem.next();a.data.forEach(function(e,t){if(e.state==4){var a=i.find(".layui-table-box tbody tr[data-index='"+t+"']").css("background-color","red").css("color","white")}else if(e.state==3){var a=i.find(".layui-table-box tbody tr[data-index='"+t+"']").css("background-color","blue").css("color","white")}else if(e.state==2){var a=i.find(".layui-table-box tbody tr[data-index='"+t+"']").css("background-color","#FF2400").css("color","white")}else if(e.state==1){var a=i.find(".layui-table-box tbody tr[data-index='"+t+"']").css("background-color","yellow")}else{var a=i.find(".layui-table-box tbody tr[data-index='"+t+"']").css("background-color","green").css("color","white")}})}});window.reloadTable=function(t){f=l.load(1,{shade:[.5,"#ccc"]});d.extend(true,e,t);i.reload("userTable",{where:e})};d(".btn-cancel").click(function(e){var t=d(e.target).parents(".layui-layer").attr("id").replace("layui-layer","");l.close(t)});i.on("toolbar(test)",function(e){var t=i.checkStatus(e.config.id),a=t.data;switch(e.event){case"start":d("#fushen")[0].reset();y=l.open({type:1,content:d("#dlg"),title:"发布复审",area:["400px","250px"],cancel:function(){d("#dlg").hide()}});break;case"reset":d("#form1")[0].reset();break}});var y=0;n.on("submit(query)",function(t){e=t.field;reloadTable(t.field);return false});n.on("submit(tijiao)",function(e){var t=i.checkStatus("userTable"),a=t.data;if(a.length==0){l.msg("请选择复审人员");return false}e.field.userlist=a;var r=l.load();d.ajax({type:"post",url:"fushen.do",dateType:"json",contentType:"application/json",data:JSON.stringify(e.field),success:function(e){l.closeAll();if(e.flag){reloadTable({});s.showInfo(e.message);return}l.msg(e.message)}});return false})});